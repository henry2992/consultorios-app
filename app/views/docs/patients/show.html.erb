<div class="container-fluid" #historia id="historia">
<% unless @patient.history.blank? %>
    <div class="row">
        <div class="col-sm-12 center">
          <h2>Historia Clinica</h2>
        </div>
    </div>
    <div class="row">
      <div class="col-6 col-sm-4 col-md-4 col-lg-3 left ">
        <b>Fecha:</b> <%= @patient.history.created_at.strftime("%d-%m-%Y") %>
      </div>
      <div class="col-6 col-sm-4 col-md-4 col-lg-3  col-sm-offset-4 col-md-offset-4 col-lg-offset-5  left">
        <b>Código:</b> <%= @patient.history.code %>
      </div>
    </div>
    <div class="row">
      <div class="col-8 col-sm-8 col-md-8 left">
        <b>Nombre y Apellido:</b> <%= @patient.full_name.titleize %>
      </div>
      <div class="col-8 col-sm-8 col-md-4 left">
        <b>Edad:</b> <%= @patient.age %>
      </div>
    </div>
    <div class="row">
        <div class="col-12 col-xs-12 col-sm-4 col-md-4 left">
            <b>Sexo:</b> <%= @patient.gender.titleize %>
        </div>
        <div class="col-12 col-xs-12 col-sm-4 col-md-4 left">
            <b>C.I.:</b> <%= @patient.national_id %>
        </div>
        <div class="col-12 col-xs-12 col-sm-4 col-md-4 left">
            <b>Fecha de Nacimiento:</b> <%= @patient.dob.strftime("%d-%m-%Y") unless @patient.dob.blank? %>
        </div>
    </div>
    <div class="row">
        <div class="col-12 col-sm-12 left">
            <b>Lugar de Nacimiento:</b> <%= @patient.pob %>
        </div>
    </div>
    <div class="row">
        <div class="col-12 col-sm-6 col-md-6 left">
            <b>Teléfono Hab:</b> <%= @patient.phone %>
        </div>
        <div class="col-12 col-sm-6 col-md-6 left">
            <b>Teléfono Cel:</b> <%= @patient.cellphone %>
        </div>
    </div>
    <div class="row">
        <div class="col-12 col-sm-6 col-md-6 left">
            <b>Teléfono Ofic:</b> <%= @patient.office_phone %>
        </div>
        <div class="col-12 col-sm-6 col-md-6 left">
            <b>Odont. Tratante:</b> <%= @patient.doctor.full_name.titleize %>
        </div>
    </div>
    <%= semantic_form_for ([:docs, @history]), :html => { class: "row" } do |f| %>
    <!-- <form class="row"> -->
        <div class="col-md-12">
            <div class="form-group">
                <label for="">Antecedentes Familiares</label>
                <%= f.input :family_history, label: false, placeholder: "Antecedentes Familiares" %>
            </div>
        </div>
        <div class="col-sm-6">
            <table class="table table-bordered">
                <tr>
                    <td width=""><b>Pregunta</b></td>
                    <td width="2%"><b>Si</b></td>
                    <td width="2%"><b>No</b></td>
                </tr>
            <% Question.all.each do |q| %>
                <% if q.id <= 19 %>
                <tr>
                    <td>
                        <%= "&nbsp;&nbsp;&nbsp;".html_safe if q.question %>
                        <%= q.question_text %>
                    </td>
                    <td>
                        <% if q.show_options %>
                            <% selected = Answer.where( choice_question: ChoiceQuestion.where(choice_id: 1, question_id: q.id ).first, choice_id: 1, history: @patient.history).blank? ? false : true %>
                            <input type="radio" name="history[questions][<%= q.id %>]" value="1" <%= "checked = 'checked'" if selected %>>
                        <% end %>
                    </td>
                    <td>
                        <% if q.show_options %>
                            <% selected = Answer.where( choice_question: ChoiceQuestion.where(choice_id: 2, question_id: q.id ).first, choice_id: 2, history: @patient.history).blank? ? false : true %>
                            <input type="radio" name="history[questions][<%= q.id %>]" value="2" <%= "checked = 'checked'" if selected %>>
                        <% end %>
                    </td>
                </tr>
                <% end %>
            <% end %>
            </table>
        </div>
        <div class="col-sm-6">
            <table class="table table-bordered">
                <tr>
                    <td width=""><b>Pregunta</b></td>
                    <td width="2%"><b>Si</b></td>
                    <td width="2%"><b>No</b></td>
                </tr>
            <% Question.all.each do |q| %>
                <% if q.id > 19 %>
                <tr>
                    <td>
                        <%= "&nbsp;&nbsp;&nbsp;".html_safe if q.question %>
                        <%= q.question_text %>
                    </td>
                    <td>
                        <% if q.show_options %>
                            <% selected = Answer.where( choice_question: ChoiceQuestion.where(choice_id: 1, question_id: q.id ).first, choice_id: 1, history: @patient.history).blank? ? false : true %>
                            <input type="radio" name="history[questions][<%= q.id %>]" value="1" <%= "checked = 'checked'" if selected %>>
                        <% end %>
                    </td>
                    <td>
                        <% if q.show_options %>
                            <% selected = Answer.where( choice_question: ChoiceQuestion.where(choice_id: 2, question_id: q.id ).first, choice_id: 2, history: @patient.history).blank? ? false : true %>
                            <input type="radio" name="history[questions][<%= q.id %>]" value="2" <%= "checked = 'checked'" if selected %>>
                        <% end %>
                    </td>
                </tr>
                <% end %>
            <% end %>
            </table>
        </div>
        <div class="col-sm-12">
            <div class="form-group">
                <input type="submit" class="btn btn-success" value="Guardar">
            </div>
        </div>
    <!-- </form> -->
    <% end %>
    <div class="row">
        <div class="col-12 tira-images">
            <a href="" data-toggle="modal" data-target="#addImg"><span class="glyphicon glyphicon-plus"></span>Agregar Imagen</a>
        </div>
    </div>
    <% if @patient.history.attachments %>
    <div class="row">
        <div class="col-md-12">
            <div id="recipeCarousel" class="carousel slide w-100" data-ride="carousel">
                <div class="carousel-inner" role="listbox">
                    <% @patient.history.attachments.each_with_index do |a, i| %>
                        <div class="carousel-item <%= "active" if i == 0 %> ">
                            <%= image_tag a.image.url, { "data-toggle":"modal", "data-target":"#descImg", "data-id": a.id, "data-eq":"0", "data-description": a.description, class:"imgCarousel item d-block img-fluid" } %>
                        </div>
                    <% end %>
                </div>
                <a class="carousel-control-prev" href="#recipeCarousel" role="button" data-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#recipeCarousel" role="button" data-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </a>
            </div>
        </div>
    </div>
    <% end %>
    <div class="row">
        <div class="col-xs-12">
            <a href="" data-toggle="modal" data-target="#addEntrada"><span class="glyphicon glyphicon-plus"></span>Agregar Entrada</a>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <h4>Secuencia de Tratamiento</h4>
            <hr>
        </div>
    </div>
    <div class="row">
        <div class="col-12">
            <table class="table">
                <thead>
                    <tr>
                        <th width="2%">#</th>
                        <th width="25%">Fecha</th>
                        <th width="50%">Descripcion</th>
                        <th>Acciones</th>
                    </tr>
                </thead>

                <tbody id="sec">
                    <tr id="elem0">
                        <td>1</td>
                        <td>1/1/2017</td>
                        <td>Descripcion 1</td>
                        <td>
                            <button class="btn btn-info updSec" data-eq="0">Actualizar</button>
                            <button class="btn btn-danger delSec" data-eq="0">Eliminar</button>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<%= link_to 'Edit', edit_docs_patient_path(@patient) %> |
<%= link_to 'Back', docs_patients_path %>



<!-- MODALS -->
<div class="modal fade" id="addImg" tabindex="-1" role="dialog">
    <div class="modal-dialog">
        <%= semantic_form_for ([:docs, @attachment]), url: docs_image_path, :html => { class: "modal-content" } do |f| %>
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title center">Agregar Imagen</h4>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="exampleInputFile">Seleccione el archivo:</label>
                    <%= f.input :image, as: :file %>
                    <p class="help-block">La imagen debe tener formato .JPG .JPEG .GIF .PNG .SVG</p>
                </div>
                <div class="form-group">
                    <%= f.input :description, label: "Descripción", :input_html => { rows: 3 } %>
                </div>
            </div>
            <div class="modal-footer">
                <div class="form-group">
                    <input type="submit" class="btn btn-success" value="Guardar">
                </div>
            </div>
            <%= hidden_field :attachment, :imageable_id, :value => @patient.history.id %>
            <%= hidden_field :attachment, :imageable_type, :value => @patient.history.class.name %>
        <% end %>
    </div>
</div>

<div class="modal fade" id="updImg" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title center">Modificar Imagen</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-12 center">
                        <img src="" id="img2">
                    </div>
                </div>
                <div class="form-group">
                    <label for="exampleInputFile">Seleccione el archivo:</label>
                    <input type="file" id="exampleInputFile" accept="image/*">
                    <p class="help-block">La imagen debe tener formato .JPG .JPEG .GIF .PNG .SVG</p>
                </div>
                <div class="form-group">
                    <label>Descripción</label>
                    <textarea cols="30" rows="10" id="descripcion" class="form-control"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <div class="form-group">
                    <input type="submit" class="btn btn-success" value="Guardar">
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="descImg" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title center">Descripcion de Imagen</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-12 center">
                        <img src="" id="img">
                    </div>
                </div>
                <div class="row">
                    <div class="col-12" id="descripcion">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <div class="col-6 center">
                    <button class="btn btn-danger" id="btnDelete">Eliminar</button>
                </div>
                <div class="col-6 center">
                    <button class="btn btn-success" id="btnUpd" data-dismiss="modal" data-toggle="modal" href="#updImg">Modificar</button>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" role="dialog" tabindex="-1" id="addEntrada">
  <div class="modal-dialog modal-lg" role="document">
    <form class="modal-content form-horizonta">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title center">Agregar Entrada</h4>
        </div>
        <div class="modal-body">

           <div class="form-group">
                <label class="control-label">Motivo de la Consulta:</label>
                <!-- <div class="col-sm-12 col-md-8"> -->
                    <input type="text" class="form-control">
                <!-- </div> -->
            </div>
            <!-- <br class="hidden-xs"><br class="hidden-xs"> -->
            <div class="checkbox">
                <label class="col-xs-12 col-sm-6 col-md-6 control-label">
                <!-- <div class="col-xs-2 col-sm-6 col-md-4"> -->
                    <input type="checkbox"> <b>Dolor?</b>
                <!-- </div> -->
                </label>
            </div>
            <div class="checkbox">
                <label class="col-xs-12 col-sm-6 col-md-6 control-label">
                <!-- <div class="col-xs-2 col-sm-6 col-md-2"> -->
                    <input type="checkbox"> <b>Sangramiento de Encias?</b>
                <!-- </div> -->
                </label>
            </div>
            <br class="hidden-xs"><br class="hidden-xs">
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Control?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
                <label class="col-sm-12 col-md-2 control-label">Restauracion Protesica?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>
            <br class="hidden-xs"><br class="hidden-xs"><br class="hidden-xs hidden-md">
            <div class="form-group">
                <label class="control-label">Otro, indique cual:</label>
                <input type="text" class="form-control">   
            </div>
            <div class="form-group">
                <label class="control-label">Enfermedad Actual:</label>
                <input type="text" class="form-control">   
            </div>
            <br class="hidden-xs">
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Aspecto del Paciente?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
                <label class="col-sm-12 col-md-2 control-label">Cara?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>
            <br class="hidden-xs"><br class="hidden-xs"><br class="hidden-xs hidden-md">
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Labios y Comisura?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
                <label class="col-sm-12 col-md-2 control-label">Palpacion de Ganglios?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>
            <br class="hidden-xs"><br class="hidden-xs"><br class="hidden-xs hidden-md">
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Ganglios?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
                <label class="col-sm-12 col-md-2 control-label">A.T.M?:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>
            <br class="hidden-xs"><br class="hidden-xs"><br class="hidden-xs hidden-md">
            <div class="form-group ">
                <div class="col-xs-12">
                    <h4>Examen Clinico IntraBucal</h4>
                    <hr>
                </div>
            </div>
            <br><br>
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Carillos:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
                <label class="col-sm-12 col-md-2 control-label">Mucosa:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>

            <br class="hidden-xs"><br class="hidden-xs">
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Encia:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
                <label class="col-sm-12 col-md-2 control-label">Lengua:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>

            <br class="hidden-xs"><br class="hidden-xs">
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Paladar:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>
    

            <br><br>
            <div class="form-group ">
                <div class="col-xs-12">
                    <h4>Examenes Complementarios</h4>
                    <hr>
                </div>
            </div>
            <br><br>
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Rx Panoramica:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
                <label class="col-sm-12 col-md-2 control-label">Rx Cordal:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>
            <br class="hidden-xs"><br class="hidden-xs">
            <div class="form-group">
                <label class="col-sm-12 col-md-2 control-label">Rx Periapical:</label>
                <div class="col-sm-12 col-md-4">
                    <input type="text" class="form-control">
                </div>
            </div>

            <br class="hidden-xs"><br class="hidden-xs">
            <div class="form-group">
                <label class="control-label">Observaciones:</label>
                <input type="text" class="form-control">
            </div>

            <br class="hidden-xs">
            <div class="form-group ">
                <div class="col-xs-12">
                    <h4>Odontodiagrama</h4>
                    <hr>
                </div>
            </div>

            <br class="hidden-xs"><br class="hidden-xs"><br class="hidden-xs hidden-md">

            <div class="form-group">
                <label for="exampleInputFile">Seleccione el archivo:</label>
                <input type="file" id="exampleInputFile" accept="image/*">
                <p class="help-block">La imagen debe tener formato .JPG .JPEG .GIF .PNG .SVG</p>
            </div>

            <br class="hidden-xs">
            <div class="form-group ">
                <div class="col-xs-12">
                    <h4>Diagnostico y Plan de Tratamiento</h4>
                    <hr>
                </div>
            </div>
            <br class="hidden-xs"><br class="hidden-xs"><br class="hidden-xs hidden-md">
            <div class="form-group">
                <textarea class="form-control" rows="3"></textarea>
            </div>

        </div>
        <div class="modal-footer">
            <div class="form-group">
                <input type="submit" class="btn btn-success" value="Guardar">
            </div>
        </div>
    </form>
  </div>
<% end %>
</div>
<!-- FIN DE MODALS -->